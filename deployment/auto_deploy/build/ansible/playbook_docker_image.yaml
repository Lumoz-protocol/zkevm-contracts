- hosts: "{{ host }}"
  remote_user: "{{ user }}"
  gather_facts: True
  tasks:
    - name: Check docker installed
      command: echo "docker -v"
      register: result
      ignore_errors: True

    - name: 创建文件夹
      shell: mkdir -p {{ targetImagePath }}
      when: result is success
      register: mkdir
      ignore_errors: True

    - name: 拷贝birdge镜像到服务器
      copy: src={{ birdgeFile }} dest={{ targetImagePath }}
      when: mkdir is success
      register: result_copy_birdge_docker
      ignore_errors: True

    - name: 加载birdge镜像
      shell: echo "docker load < {{ birdgeImageFile }}"
      when: result_copy_birdge_docker is success
      register: load_birdge_docker
      ignore_errors: True

    - name: 拷贝node镜像到服务器
      copy: src={{ path }} dest={{ targetImagePath }}
      when: mkdir is success
      register: result_copy_docker
      ignore_errors: True

    - name: 加载node镜像
      shell: echo "docker load < {{ targetImageFile }}"
      when: result_copy_docker is success
      register: load_docker
      ignore_errors: True
